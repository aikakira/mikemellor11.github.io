function FastClick(a){"use strict";function b(a,b){return function(){return a.apply(b,arguments)}}var c;this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=10,this.layer=a,FastClick.notNeeded(a)||(deviceIsAndroid&&(a.addEventListener("mouseover",b(this.onMouse,this),!0),a.addEventListener("mousedown",b(this.onMouse,this),!0),a.addEventListener("mouseup",b(this.onMouse,this),!0)),a.addEventListener("click",b(this.onClick,this),!0),a.addEventListener("touchstart",b(this.onTouchStart,this),!1),a.addEventListener("touchmove",b(this.onTouchMove,this),!1),a.addEventListener("touchend",b(this.onTouchEnd,this),!1),a.addEventListener("touchcancel",b(this.onTouchCancel,this),!1),Event.prototype.stopImmediatePropagation||(a.removeEventListener=function(b,c,d){var e=Node.prototype.removeEventListener;"click"===b?e.call(a,b,c.hijacked||c,d):e.call(a,b,c,d)},a.addEventListener=function(b,c,d){var e=Node.prototype.addEventListener;"click"===b?e.call(a,b,c.hijacked||(c.hijacked=function(a){a.propagationStopped||c(a)}),d):e.call(a,b,c,d)}),"function"==typeof a.onclick&&(c=a.onclick,a.addEventListener("click",function(a){c(a)},!1),a.onclick=null))}function p(a,b){return a+" "+b+" "}function roundedRect(a,b,c,d,e,f,g,h){var i="M"+p(a+e,b);return i+="L"+p(a+c-f,b)+"Q"+p(a+c,b)+p(a+c,b+f),i+="L"+p(a+c,b+d-g)+"Q"+p(a+c,b+d)+p(a+c-g,b+d),i+="L"+p(a+h,b+d)+"Q"+p(a,b+d)+p(a,b+d-h),i+="L"+p(a,b+e)+"Q"+p(a,b)+p(a+e,b),i+="Z"}function wrap(a,b){a.each(function(){var a,c=d3.select(this),d=c.text().split(/\s+/).reverse(),e=[],f=0,g=1.1,h=c.attr("x"),i=c.attr("y"),j=0;for(tspan=c.text(null).append("tspan").attr("x",h).attr("y",i).attr("dy",j+"em");a=d.pop();)e.push(a),tspan.text(e.join(" ")),tspan.node().getComputedTextLength()>b&&e.length>1&&(e.pop(),tspan.text(e.join(" ")),e=[a],tspan=c.append("tspan").attr("x",h).attr("y",i).attr("dy",++f*g+j+"em").text(a))})}function createHtmlText(a){function b(){var a={value:parseFloat(e).toFixed(f.decimalPlaces),percent:Math.round(parseFloat(e).toFixed(0)/f.totalCount*100),total:f.totalCount};return f.extraFormatKeys.forEach(function(b){a[b.name]=b.value}),c.text(String.formatKeys(f.textFormat,a)).transition().duration(f.transitionSpeed).delay(f.delaySpeed).duration(f.transitionSpeed).tween("text",function(b){var c=d3.interpolate(e,d);return function(b){e=parseFloat(c(b)).toFixed(f.decimalPlaces),a.value=parseFloat(c(b)).toFixed(f.decimalPlaces),a.percent=Math.round(parseFloat(c(b)).toFixed(0)/f.totalCount*100),a.total=f.totalCount,this.textContent=String.formatKeys(f.textFormat,a)}}),b}if(!a)return null;var c;c="string"==typeof a?d3.selectAll(a):d3.select(a);var d=0,e=0,f={textFormat:"{value}",extraFormatKeys:[],transitionSpeed:800,transitionType:"cubic-in-out",delaySpeed:1e3,totalCount:100,decimalPlaces:0};return b.data=function(a){return arguments.length?(e=d,d=a,b):d},b.attr=function(a){if(!arguments.length)return f;for(var c in a)if(a.hasOwnProperty(c))if(Array.isArray(f[c]))f[c]=a[c];else if(f[c]===Object(f[c]))for(var d in f[c])a[c].hasOwnProperty(d)&&(f[c][d]=a[c][d]);else f[c]=a[c];return b},b}function createLine(a){function b(){s||(s=d3.time.format(u.dateFormat).parse),g(),n=u.width-u.margin.left-u.margin.right,v.bottom=j(),m=u.height-u.margin.top-v.bottom,e(),i(t);var a=d3.svg.line().interpolate(u.interpolation).defined(function(a){return null!==a.value}).x(function(a){return q(d(a))}).y(function(a){return r(c(a))}),b=o.selectAll(".line").data(t),f=b.enter().append("g").attr("class","line");f.append("path").attr("class",function(a,b){return"line__stroke "+u.colors[b%u.colors.length]+"-stroked"}),b.select("path").style("stroke-dasharray",function(a,b){return a.dashedLine?a.dashedLine:u.dashedLine}).attr("d",function(b){return a(b.values)}),b.exit().transition().duration(u.transitionSpeed).style("opacity",0).remove(),b.each(function(a,b){var e=d3.select(this).selectAll(".plots").data(a.values),f=e.enter().append("g").attr("class","plots");u.foreignObjects||(f.append("text").attr("y","1em").attr("x",0).attr("opacity",0),e.select("text").attr("transform",function(a,b){return"translate("+q(d(a))+", "+(r(+c(a))+u.labelPadding)+")"}).style("text-anchor",function(a,b){return n-q(d(a))<.2*n?"end":n-q(d(a))>.8*n?"start":"middle"}).text(function(a,b){return h(a)}).call(wrap,50).transition().delay(function(a,b){return b*u.stagger+u.delaySpeed}).duration(u.transitionSpeed).attr("opacity",function(a){return c(a)?1:0})),u.symbols&&(f.append("path").attr("class",function(a,c){return"line__symbol "+u.colors[b%u.colors.length]}).attr("opacity",0),e.select("path").attr("transform",function(a){return"translate("+q(d(a))+","+r(c(a))+")"}).attr("d",d3.svg.symbol().type(function(b,c){return b.symbolType?b.symbolType:a.symbolType?a.symbolType:u.symbolType}).size(u.symbolSize)).transition().delay(function(a,b){return b*u.stagger+u.delaySpeed}).duration(u.transitionSpeed).ease(u.transitionType).attr("opacity",function(a){return c(a)?1:0})),e.exit().transition().duration(u.transitionSpeed).style("opacity",0).remove()})}function c(a){return u.plotYValue?a.value[u.plotYValue]:a.value}function d(a){return null===u.plotXValue?a.id:"date"===u.plotXValue?s(a.id):u.plotXValue(a.id)}function e(){l.select(".yLabel").attr("transform","translate(0, "+(u.margin.top+.5*m)+") rotate(-90)").select("text").text(u.yLabel).call(wrap,m),l.select(".xLabel").select("text").text(u.xLabel).call(wrap,n).attr("transform",function(){return"translate("+(u.margin.left+.5*n)+", "+(m+u.margin.top+v.bottom-this.getBBox().height)+")"});var a=t.map(function(a,b){return a.values}).reduce(function(a,b){return a.concat(b)});q=null===u.xScale?d3.scale.ordinal().domain(a.map(function(a){return a.id})).rangeRoundPoints([0,n],u.padding.outer):"date"===u.xScale?d3.time.scale().domain([u.xMin?s(u.xMin):d3.min(a,function(a){return s(a.id)}),u.xMax?s(u.xMax):d3.max(a,function(a){return s(a.id)})]).nice(d3.time.week).range([0,n]):u.xScale(u,t),r=d3.scale.linear().domain([u.yMin?u.yMin:d3.min(t,function(a){return d3.min(a.values,function(a){return+c(a)})}),u.yMax?u.yMax:d3.max(t,function(a){return d3.max(a.values,function(a){return+c(a)})})]).range(u.flipYAxis?[0,m]:[m,0]);var b=d3.svg.axis().scale(q).innerTickSize(-m).outerTickSize(1).tickPadding(10).ticks(u.ticks).orient("bottom"),d=d3.svg.axis().scale(r).innerTickSize(-n).outerTickSize(1).tickPadding(10).ticks(u.ticks).orient("left");l.select(".x.axis").attr("transform","translate("+u.margin.left+", "+(u.margin.top+m)+")").call(b),l.select(".y.axis").attr("transform","translate("+u.margin.left+", "+u.margin.top+")").call(d),p.attr("transform","translate("+u.margin.left+","+u.margin.top+")"),o.attr("transform","translate("+u.margin.left+","+u.margin.top+")")}function f(){g(),l.append("g").attr("class","yLabel").append("text").attr("y","1em").attr("x",0),l.append("g").attr("class","xLabel").append("text").attr("y","0.8em").attr("x",0),l.append("g").attr("class","x axis"),l.append("g").attr("class","y axis"),p=l.append("g").attr("class","bottom"),o=l.append("g").attr("class","draw")}function g(){u.height=u.width*u.aspectRatio,l.attr("viewBox","0 0 "+u.width+" "+u.height)}function h(a){return String.format(u.labelFormat,c(a),a.label,a.id)}function i(a){var b='<ul class="key__list">';a.forEach(function(a,c){b+='<li class="key__key '+u.colors[c%u.colors.length]+'">',b+=a.label,b+="</li>"}),b+="</ul>",d3.select(u.keySelector).html(b)}function j(){var a=0;return"x"===u.autoAxis?(u.foreignObjects||u.xLabel&&(a+=+k(u.xLabel,n)),a+=u.margin.bottom):a=u.margin.bottom,a}function k(a,b){var c=0;return l.append("text").attr("y","1em").attr("x",0).text(a).call(wrap,b).each(function(){c=this.getBBox().height}).remove(),c}if(!a)return null;var l;l="string"==typeof a?d3.selectAll(a):d3.select(a);var m,n,o,p,q,r,s=null,t=[],u={margin:{top:10,right:10,bottom:30,left:75},padding:{outer:0},width:768,height:432,transitionSpeed:800,delaySpeed:800,stagger:200,labelPadding:10,labelFormat:"{1}",aspectRatio:.5625,colors:["fill1","fill2","fill3","fill4","fill5","fill6"],yLabel:null,xLabel:null,xMin:null,xMax:null,yMin:null,yMax:null,foreignObjects:!1,flipYAxis:!1,autoAxis:"x",interpolation:"linear",symbols:!0,symbolSize:100,symbolType:"circle",transitionType:"cubic-in-out",keySelector:".key",ticks:10,dashedLine:0,dateFormat:"%d/%m/%y",xScale:null,plotXValue:null,plotYValue:null},v={bottom:0,left:0};return f(),b.width=function(a){return arguments.length?(u.width=a,b):u.width},b.data=function(a){return arguments.length?(t=a,b):t},b.stagger=function(a){return arguments.length?(u.stagger=a,b):u.stagger},b.attr=function(a){if(!arguments.length)return u;for(var c in a)if(a.hasOwnProperty(c))if(Array.isArray(u[c]))u[c]=a[c];else if(u[c]===Object(u[c]))for(var d in u[c])a[c].hasOwnProperty(d)&&(u[c][d]=a[c][d]);else u[c]=a[c];return b},b}var deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);FastClick.prototype.needsClick=function(a){"use strict";switch(a.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(a.disabled)return!0;break;case"input":if(deviceIsIOS&&"file"===a.type||a.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(a.className)},FastClick.prototype.needsFocus=function(a){"use strict";switch(a.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}},FastClick.prototype.sendClick=function(a,b){"use strict";var c,d;document.activeElement&&document.activeElement!==a&&document.activeElement.blur(),d=b.changedTouches[0],c=document.createEvent("MouseEvents"),c.initMouseEvent(this.determineEventType(a),!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),c.forwardedTouchEvent=!0,a.dispatchEvent(c)},FastClick.prototype.determineEventType=function(a){"use strict";return deviceIsAndroid&&"select"===a.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(a){"use strict";var b;deviceIsIOS&&a.setSelectionRange&&0!==a.type.indexOf("date")&&"time"!==a.type?(b=a.value.length,a.setSelectionRange(b,b)):a.focus()},FastClick.prototype.updateScrollParent=function(a){"use strict";var b,c;if(b=a.fastClickScrollParent,!b||!b.contains(a)){c=a;do{if(c.scrollHeight>c.offsetHeight){b=c,a.fastClickScrollParent=c;break}c=c.parentElement}while(c)}b&&(b.fastClickLastScrollTop=b.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(a){"use strict";return a.nodeType===Node.TEXT_NODE?a.parentNode:a},FastClick.prototype.onTouchStart=function(a){"use strict";var b,c,d;if(a.targetTouches.length>1)return!0;if(b=this.getTargetElementFromEventTarget(a.target),c=a.targetTouches[0],deviceIsIOS){if(d=window.getSelection(),d.rangeCount&&!d.isCollapsed)return!0;if(!deviceIsIOS4){if(c.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=c.identifier,this.updateScrollParent(b)}}return this.trackingClick=!0,this.trackingClickStart=a.timeStamp,this.targetElement=b,this.touchStartX=c.pageX,this.touchStartY=c.pageY,a.timeStamp-this.lastClickTime<200&&a.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(a){"use strict";var b=a.changedTouches[0],c=this.touchBoundary;return Math.abs(b.pageX-this.touchStartX)>c||Math.abs(b.pageY-this.touchStartY)>c},FastClick.prototype.onTouchMove=function(a){"use strict";return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},FastClick.prototype.findControl=function(a){"use strict";return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(a){"use strict";var b,c,d,e,f,g=this.targetElement;if(!this.trackingClick)return!0;if(a.timeStamp-this.lastClickTime<200)return this.cancelNextClick=!0,!0;if(this.cancelNextClick=!1,this.lastClickTime=a.timeStamp,c=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(f=a.changedTouches[0],g=document.elementFromPoint(f.pageX-window.pageXOffset,f.pageY-window.pageYOffset)||g,g.fastClickScrollParent=this.targetElement.fastClickScrollParent),d=g.tagName.toLowerCase(),"label"===d){if(b=this.findControl(g)){if(this.focus(g),deviceIsAndroid)return!1;g=b}}else if(this.needsFocus(g))return a.timeStamp-c>100||deviceIsIOS&&window.top!==window&&"input"===d?(this.targetElement=null,!1):(this.focus(g),this.sendClick(g,a),deviceIsIOS4&&"select"===d||(this.targetElement=null,a.preventDefault()),!1);return deviceIsIOS&&!deviceIsIOS4&&(e=g.fastClickScrollParent,e&&e.fastClickLastScrollTop!==e.scrollTop)?!0:(this.needsClick(g)||(a.preventDefault(),this.sendClick(g,a)),!1)},FastClick.prototype.onTouchCancel=function(){"use strict";this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(a){"use strict";return this.targetElement?a.forwardedTouchEvent?!0:a.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1):!0:!0},FastClick.prototype.onClick=function(a){"use strict";var b;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===a.target.type&&0===a.detail?!0:(b=this.onMouse(a),b||(this.targetElement=null),b)},FastClick.prototype.destroy=function(){"use strict";var a=this.layer;deviceIsAndroid&&(a.removeEventListener("mouseover",this.onMouse,!0),a.removeEventListener("mousedown",this.onMouse,!0),a.removeEventListener("mouseup",this.onMouse,!0)),a.removeEventListener("click",this.onClick,!0),a.removeEventListener("touchstart",this.onTouchStart,!1),a.removeEventListener("touchmove",this.onTouchMove,!1),a.removeEventListener("touchend",this.onTouchEnd,!1),a.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(a){"use strict";var b,c;if("undefined"==typeof window.ontouchstart)return!0;if(c=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!deviceIsAndroid)return!0;if(b=document.querySelector("meta[name=viewport]")){if(-1!==b.content.indexOf("user-scalable=no"))return!0;if(c>31&&window.innerWidth<=window.screen.width)return!0}}return"none"===a.style.msTouchAction},FastClick.attach=function(a){"use strict";return new FastClick(a)},"undefined"!=typeof define&&define.amd?define(function(){"use strict";return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,String.format||(String.format=function(a){var b=Array.prototype.slice.call(arguments,1);return String(a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a}))}),String.formatKeys||(String.formatKeys=function(a){var b=arguments[1];return String(a.replace(/{(\w+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a}))});var chartManager=function(){"use strict";var a=null,b={colors:["fill1","fill2","fill3","fill4","fill5","fill6","fill7","fill8"],yLabel:"Weight (kg)",margin:{right:40,bottom:40},ticks:5,plotYValue:"weight",plotXValue:"date",xScale:"date",transitionSpeed:0,delaySpeed:0,stagger:0};return{charts:null,chartIndex:0,init:function(){a=createLine(".chart").width(document.querySelector(".delta").offsetWidth)},update:function(){d3.json("media/"+this.charts[this.chartIndex].name+".json",function(c,d){c||a.attr(b).attr(d.attributes).data(d.data).call(a)})}}}();!function(){"use strict";FastClick.attach(document.body),baseJS(),pageJS()}(),Array.prototype.last||(Array.prototype.last=function(){"use strict";return this[this.length-1]}),Array.prototype.fromEnd||(Array.prototype.fromEnd=function(a){"use strict";return this[this.length-(a+1)]});