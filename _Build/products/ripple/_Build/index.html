{{#with content.index}}
    <!doctype html>
    {{> htmlTag}} 
        <head>
            {{> head}}
        </head>
        <body>
            {{> header}}

            {{> breadcrumb}}

            <main class="container">
                <div class="innerContainer">
                    <div class="full ut-material">
                        <div class="full ut-bg2 ut-paddingPercent ut-borderBox">
                            {{#each this.focusList}}
                            <h4>{{{this.text}}}</h4>
                            {{/each}}

                            <div class="full">
                                <div class="half">
                                    <h3>{{{this.browse}}}</h3>

                                    <div class="form__group">
                                        <div class="selectBox">
                                            <span class="fancyArrow {{> iconOnly name='down-open'}}"></span>
                                            <select id="js_categories" onchange="populateSubCategories(); populateAutocomplete(); countArticles();"></select>
                                        </div>
                                    </div>

                                    <div class="form__group">
                                        <div class="selectBox selectBox-noItems">
                                            <span class="fancyArrow {{> iconOnly name='down-open'}}"></span>
                                            <select id="js_subCategories" onchange="populateAutocomplete(); countArticles();" disabled></select>
                                        </div>
                                    </div>

                                    <div class="form__group">
                                        <div class="selectBox">
                                            <span class="fancyArrow {{> iconOnly name='down-open'}}"></span>
                                            <select id="js_lastUpdated" onchange="countArticles();">
                                                <option value="0" disabled selected hidden>{{{this.updated}}}</option>
                                                {{#each this.updatedList}}
                                                <option value="{{this.value}}">{{{this.text}}}</option>
                                                {{/each}}
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form__group ut-table ut-textAlignRight">
                                        <div class="ut-tableCell ut-maxWidth ut-textAlignLeft ut-mobileCell"><span class="js_articleTotal ut-boldFont">0</span> {{{this.articles}}}</div>
                                        <button id="navBrowse" class="js_searchButton ut-tableCell button ut-mobileCell">{{{this.browseButton}}}</button>
                                    </div>
                                </div>

                                <div class="half">
                                    <h3>{{{this.search}}}</h3>

                                    <div class="form__group">
                                        <div class="form__input">
                                            <input type="text" id="js_searchTerms" name="search" placeholder="Search">
                                            <button type="submit" class="button button-alt innerFormButton ut-paddingRight ut-paddingLeft js_clearSearch" style="display:none;">
                                                {{> icon name="cancel" class="iconSmallest" flip=true}}
                                                <span class="ut-vertAlignCenter">{{{this.clear}}}</span>
                                            </button>
                                        </div>
                                    </div>

                                    <div class="form__group ut-textAlignRight">
                                        <p class="ut-pointer ut-inlineBlock ut-vertAlignCenter ut-noMargin ut-paddingRight js_toggleLabel">{{{this.filter}}}</p>
                                        <div class="ut-inlineBlock ut-vertAlignCenter toggleWrapper">
                                            <input type="checkbox" name="toggle" class="toggle" id="toggle">
                                            <label for="toggle"></label>
                                        </div>
                                    </div>

                                    <div class="form__group ut-textAlignRight">
                                        <button data-search="true" id="navSearch" class="js_searchButton button ut-mobileFull" title="Category Search">{{{this.searchButton}}}</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {{> downloads @root.global.fullDownload}}
                        {{> downloads @root.global.recentDownload}}
                        
                        <div class="full ut-bg2 ut-paddingPercent ut-borderBox">
                            <h4>{{{this.note}}}</h4>
                            <ul>
                                {{#each this.noteList}}
                                    <li class="{{#unless @first}}ut-paddingTopLarge{{/unless}}">{{{this.text}}}</li>
                                {{/each}}
                            </ul>
                        </div>
                    </div>
                </div>
            </main>
            {{> footer}}
        </body>
        <script type="text/javascript">
            function pageJS(){
                popuplateCategories();
                populateSubCategories();
                populateAutocomplete();
                countArticles();

                $('.js_toggleLabel').click(function(){
                    $('#toggle').click();
                });

                $(".js_searchButton").click(function (event) {
                    var currentCategory = getDDLSelectedValue("js_categories");
                    var currentSubCategory = getDDLSelectedValue("js_subCategories");
                    var currentLastUpdated = getDDLSelectedValue("js_lastUpdated");
                    var currentSearch = $('#js_searchTerms').val().split(',');

                    $.each(currentSearch, function(i, d){
                        currentSearch[i] = $.trim(d);
                    });

                    currentSearch = currentSearch.join();

                    if(currentSearch === ''){
                        currentSearch = 0;
                    }

                    if(!+document.getElementById("toggle").checked && ($(this).data('search'))){
                        currentCategory = 0;
                        currentSubCategory = 0;
                        currentLastUpdated = 0;
                    }

                    var queryString = "?cat=" + currentCategory;
                    queryString += "&sub=" + currentSubCategory;
                    queryString += "&last=" + currentLastUpdated;
                    queryString += "&search=" + encodeURIComponent((($(this).data('search')) ? currentSearch : 0));
                    queryString += "&filter=" + (($(this).data('search')) ? +document.getElementById("toggle").checked : 0);

                    this.href = "results.html" + queryString;
                    window.location = this.href;
                });

                $('.js_clearSearch').click(function (event) {
                    $('#js_searchTerms').val('');
                    $(this).hide();
                });

                var elem = $('#js_searchTerms');
                elem.data('oldVal', elem.val());

                elem.bind("propertychange change click keyup input paste", function(event){
                    (elem.val().length > 0) ? ($('.js_clearSearch').show(), $('#js_searchTerms').addClass('clearShow')) : ($('.js_clearSearch').hide(), $('#js_searchTerms').removeClass('clearShow'));

                    if (elem.data('oldVal') != elem.val()) {
                        elem.data('oldVal', elem.val());
                    }
                });
            };
        </script>
        <script type="text/javascript" src="js/script.js"></script>
    </html>
{{/with}}